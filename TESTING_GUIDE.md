# Testing Guide - Event Ticketing System

## Prerequisites Setup

### 1. Start MongoDB
Make sure MongoDB is running on your system:

**Option A: Local MongoDB**
```bash
# Windows (if MongoDB is installed)
mongod

# Or use MongoDB as a Windows Service (it may already be running)
```

**Option B: MongoDB Atlas (Cloud)**
- No need to run locally
- Just ensure your `.env` has the correct Atlas connection string

### 2. Start the Development Server
```bash
npm run dev
```

The app will start at: http://localhost:3000

## Testing the Application

### Test 1: Owner Creates a Ticket

1. **Go to**: http://localhost:3000
2. **Click**: "Owner Portal" → "Sign Up"
3. **Create Account**:
   - Name: Test Owner
   - Email: owner@test.com
   - Password: password123
   - Confirm Password: password123
4. **Click**: Sign Up
5. **You'll be redirected to Dashboard**
6. **Fill Ticket Form**:
   - Customer Name: John Doe
   - Customer Phone: +1234567890
   - Customer Email: john@test.com
   - Event Name: Summer Festival 2024
   - Event Date: (select any future date)
   - Additional Details: VIP Pass
7. **Click**: "Generate Ticket & QR Code"
8. **Result**: You should see:
   - Success message
   - Ticket ID (e.g., TKT-XXXXX-XXXXX)
   - QR Code image
9. **Save the QR Code**:
   - Right-click on QR code → Save image as
   - Save to your desktop for testing

### Test 2: Client Scans with Camera

1. **Open New Browser Tab**: http://localhost:3000
2. **Click**: "Client Portal" → "Sign Up"
3. **Create Account**:
   - Name: Scanner Staff
   - Email: staff@test.com
   - Password: password123
   - Confirm Password: password123
4. **Click**: Sign Up
5. **You'll be redirected to Scanner**
6. **Click**: "Use Camera" button
7. **Allow Camera Permission** when browser prompts
8. **Camera should activate** (green light on laptop)
9. **Show QR Code to Camera**:
   - Open the saved QR code image on your phone or another screen
   - Hold it in front of the camera
10. **Result**: Should automatically scan and show ticket details

### Test 3: Client Scans by Upload

1. **On Client Scanner Page**
2. **Click**: "Upload Image" button
3. **Select**: The QR code image you saved earlier
4. **Result**: Should process and show ticket details immediately

### Test 4: Verify Entry

1. **After scanning** (camera or upload), you should see:
   - Ticket ID
   - Customer Name: John Doe
   - Event: Summer Festival 2024
   - Phone: +1234567890
   - Entry Status: "Not Yet Entered"
2. **Check the confirmation checkbox**
3. **Click**: "Verify Entry"
4. **Result**: 
   - Success message
   - Entry Status changes to "Already Entered"
   - Timestamp is recorded

### Test 5: Duplicate Entry Prevention

1. **Try to scan the same QR code again**
2. **Result**: Should show:
   - "Already Entered" status
   - Original entry timestamp
   - Cannot verify entry again

## Common Issues & Solutions

### Issue: Camera Not Turning On

**Causes:**
- Browser doesn't have camera permission
- Another app is using the camera
- Using HTTP instead of HTTPS (on deployment)

**Solutions:**
- Check browser settings → Site permissions → Camera → Allow
- Close other apps using camera (Zoom, Teams, etc.)
- Try a different browser (Chrome recommended)
- Use "Upload Image" as alternative

### Issue: MongoDB Connection Error

**Error Message**: "MongooseServerSelectionError: connect ECONNREFUSED"

**Solution:**
```bash
# Start MongoDB locally
mongod

# OR update .env with MongoDB Atlas connection string
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/event-ticketing
```

### Issue: QR Code Upload Not Working

**Causes:**
- Image is too blurry
- QR code is too small in image
- Image format not supported

**Solutions:**
- Use a clear, high-resolution image
- Crop the image to focus on QR code
- Ensure image is JPG, PNG, or GIF format
- Try camera scan instead

### Issue: "Invalid QR Code" Error

**Cause**: Scanning a QR code not generated by this system

**Solution**: Only scan QR codes generated from the Owner Dashboard

## Test Checklist

- [ ] Owner can sign up
- [ ] Owner can login
- [ ] Owner can create tickets
- [ ] QR code is generated and displayed
- [ ] Client can sign up
- [ ] Client can login
- [ ] Camera scan works (green light turns on)
- [ ] Image upload scan works
- [ ] Ticket details display correctly
- [ ] Entry can be verified
- [ ] Duplicate scans are prevented
- [ ] Entry timestamp is saved

## Browser Recommendations

**Best Performance:**
- Chrome (latest)
- Edge (latest)
- Firefox (latest)

**Camera Support:**
- Works on all modern browsers
- HTTPS required for production deployment
- Some features may need permission prompts

## Mobile Testing

The app is responsive and works on mobile devices:

1. **Make app accessible on network**:
   ```bash
   # Update next.config.js if needed, then:
   npm run dev -- -H 0.0.0.0
   ```

2. **Access from mobile**:
   - Find your computer's local IP (e.g., 192.168.1.100)
   - On mobile browser: http://192.168.1.100:3000

3. **Mobile camera** works better for scanning QR codes

## Database Verification

You can check if tickets are saved in MongoDB:

```bash
# Open MongoDB shell
mongosh

# Switch to database
use event-ticketing

# View all tickets
db.tickets.find().pretty()

# View all users
db.users.find().pretty()

# Check entries
db.tickets.find({ hasEntered: true }).pretty()
```

## Need Help?

If you encounter any issues not covered here:
1. Check browser console for error messages (F12 → Console)
2. Ensure all dependencies are installed (`npm install`)
3. Verify MongoDB is running
4. Check `.env` file configuration
